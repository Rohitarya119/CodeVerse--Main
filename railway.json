{
    "$schema": "https://railway.app/railway.schema.json",
    "services": [
        {
            "name": "codeverse-db",
            "description": "PostgreSQL Database (Optional - if you don't use Supabase)",
            "image": "postgres:15-alpine",
            "variables": {
                "POSTGRES_USER": "postgres",
                "POSTGRES_PASSWORD": "${{PostgresPassword}}",
                "POSTGRES_DB": "codeverse"
            }
        },
        {
            "name": "backend",
            "description": "Spring Boot Backend",
            "root": "Backend/codeverse-backend",
            "dockerfilePath": "Dockerfile",
            "variables": {
                "PORT": "8081",
                "SPRING_DATASOURCE_URL": "${{codeverse-db.DATABASE_URL}}",
                "SPRING_DATASOURCE_USERNAME": "${{POSTGRES_USER}}",
                "SPRING_DATASOURCE_PASSWORD": "${{POSTGRES_PASSWORD}}",
                "FRONTEND_URL": "https://${{frontend.RAILWAY_PUBLIC_DOMAIN}}",
                "CORS_ALLOWED_ORIGINS": "https://${{frontend.RAILWAY_PUBLIC_DOMAIN}}"
            },
            "dependsOn": [
                "codeverse-db"
            ]
        },
        {
            "name": "frontend",
            "description": "React + Vite Frontend",
            "root": "Frontend",
            "dockerfilePath": "Dockerfile",
            "variables": {
                "VITE_API_BASE_URL": "https://${{backend.RAILWAY_PUBLIC_DOMAIN}}"
            },
            "dependsOn": [
                "backend"
            ]
        },
        {
            "name": "executor",
            "description": "Code Execution Service",
            "root": "server",
            "dockerfilePath": "Dockerfile",
            "variables": {
                "PORT": "3000"
            }
        }
    ]
}